export component DottedGridBackground inherits Rectangle {
	in property <float> zoom: 1.0;
	in property <length> pan-x: 0px;
	in property <length> pan-y: 0px;
	in property <length> minor-step: 52px;
	in property <int> major-every: 5;
	in property <length> minor-dot-size: 6px;
	in property <float> major-dot-scale: 1.3;
	in property <brush> minor-color: #1d2a3d;
	in property <brush> major-color: #2d3f5a;

	private property <length> minor-step-screen: root.minor-step * root.zoom;
	private property <length> major-step-screen: root.minor-step-screen * root.major-every;
	private property <length> minor-origin-x: root.pan-x - floor(root.pan-x / root.minor-step-screen) * root.minor-step-screen;
	private property <length> minor-origin-y: root.pan-y - floor(root.pan-y / root.minor-step-screen) * root.minor-step-screen;
	private property <length> major-origin-x: root.pan-x - floor(root.pan-x / root.major-step-screen) * root.major-step-screen;
	private property <length> major-origin-y: root.pan-y - floor(root.pan-y / root.major-step-screen) * root.major-step-screen;
	private property <int> minor-row-count: ceil(root.height / root.minor-step-screen) + 4;
	private property <int> minor-col-count: ceil(root.width / root.minor-step-screen) + 4;
	private property <int> major-row-count: ceil(root.height / root.major-step-screen) + 4;
	private property <int> major-col-count: ceil(root.width / root.major-step-screen) + 4;
	private property <length> major-dot-size: root.minor-dot-size * root.major-dot-scale;

	clip: true;
	background: transparent;

	for _[row] in root.minor-row-count : Rectangle {
		x: 0px;
		y: root.minor-origin-y + row * root.minor-step-screen;
		width: parent.width;
		height: 0px;
		background: transparent;

		for _[col] in root.minor-col-count : Rectangle {
			x: root.minor-origin-x + col * root.minor-step-screen - root.minor-dot-size / 2;
			y: -root.minor-dot-size / 2;
			width: root.minor-dot-size;
			height: root.minor-dot-size;
			border-radius: root.minor-dot-size / 2;
			background: root.minor-color;
		}
	}

	for _[row] in root.major-row-count : Rectangle {
		x: 0px;
		y: root.major-origin-y + row * root.major-step-screen;
		width: parent.width;
		height: 0px;
		background: transparent;

		for _[col] in root.major-col-count : Rectangle {
			x: root.major-origin-x + col * root.major-step-screen - root.major-dot-size / 2;
			y: -root.major-dot-size / 2;
			width: root.major-dot-size;
			height: root.major-dot-size;
			border-radius: root.major-dot-size / 2;
			background: root.major-color;
		}
	}
}
